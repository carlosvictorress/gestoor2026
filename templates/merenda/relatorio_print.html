<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>{{ doc.tipo_documento }} {{ doc.numero_documento }}</title>

    <style>
        /* ================= CONFIGURA√á√ÉO DA P√ÅGINA ================= */
        @page {
            size: A4;
            /* Margens padr√£o - Deixe a impressora respirar */
            margin: 1cm 1.5cm; 
        }

        body {
            font-family: "Times New Roman", Times, serif;
            font-size: 12pt;
            line-height: 1.35;
            color: #000;
            margin: 0;
            padding: 0;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        /* CONFIGURA√á√ÉO DO FUNDO (MARCA D'√ÅGUA) 
           Aplicamos no body para cobrir tudo */
        body {
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.80), rgba(255, 255, 255, 0.80)),
                url("{{ url_for('static', filename='marcadagua.png') }}");
            background-repeat: no-repeat;
            background-position: center center;
            background-size: 60%; /* Um pouco menor para garantir que caiba */
            background-attachment: fixed;
        }

        /* ================= ESTRUTURA M√ÅGICA DE TABELA ================= */
        /* Isso garante que cabe√ßalho e rodap√© se repitam e respeitem as margens */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        /* O Header e o Footer da tabela t√™m altura fixa */
        thead { display: table-header-group; }
        tfoot { display: table-footer-group; }
        
        /* Espa√ßos vazios para garantir que o conte√∫do n√£o cubra o cabe√ßalho/rodap√© */
        .header-space { height: 3.5cm; }
        .footer-space { height: 2cm; }

        /* ================= CONTE√öDO FIXO (Header e Footer Reais) ================= */
        .page-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3.5cm;
            text-align: center;
            background: transparent; /* Importante para ver a marca d'agua */
        }

        .page-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1.5cm; /* Altura do rodap√© */
            
            /* Estilo do Rodap√© */
            text-align: center;
            font-size: 10pt;
            border-top: 1px solid #000;
            padding-top: 5px;
            background: rgba(255, 255, 255, 0.9); /* Fundo branco leve para leitura */
        }

        /* ================= ESTILOS DO TEXTO ================= */
        .doc-title {
            text-align: center;
            font-weight: bold;
            font-size: 14pt;
            text-transform: uppercase;
            text-decoration: underline;
            margin: 1cm 0;
        }

        .block { margin-bottom: 0.6cm; }

        .destinatario strong { display: block; margin-bottom: 4px; }
        .destinatario .nome { font-weight: bold; font-size: 1.05em; margin-bottom: 3px; }

        .assunto { font-weight: bold; margin-top: 0.8cm; }

        .paragraph {
            text-align: justify;
            text-indent: 2cm;
            margin-bottom: 0.5cm;
            white-space: pre-wrap;
        }

        .fecho { text-align: right; margin-top: 1cm; margin-bottom: 2cm; }

        .signature { text-align: center; page-break-inside: avoid; }
        .signature-line { border-top: 1px solid #000; width: 55%; margin: 0 auto 5px auto; }
        .signature-name { font-weight: bold; }
        .signature-role { font-size: 10pt; font-style: italic; }

        .header-content img { height: 2.2cm; width: auto; display: block; margin: 0 auto 5px auto; }
        .header-content h3 { margin: 0; font-size: 14pt; font-weight: bold; text-transform: uppercase; }
        .header-content h4 { margin: 2px 0 0 0; font-size: 12pt; font-weight: bold; text-transform: uppercase; }
        
        .footer-content p { margin: 2px 0; font-weight: bold; }

        /* Bot√£o */
        .no-print { position: fixed; top: 10px; right: 10px; padding: 8px 15px; background: #333; color: #fff; border-radius: 5px; cursor: pointer; z-index: 9999; }
        @media print { .no-print { display: none; } }

    </style>
</head>

<body>
    <button class="no-print" onclick="window.print()">üñ®Ô∏è IMPRIMIR</button>

    <div class="page-header">
        <div class="header-content">
            <img src="{{ url_for('static', filename='timbre.jpg') }}" alt="Bras√£o">
            <h3>PREFEITURA MUNICIPAL DE VALEN√áA DO PIAU√ç</h3>
            <h4>SECRETARIA MUNICIPAL DE EDUCA√á√ÉO</h4>
        </div>
    </div>

    <div class="page-footer">
        <div class="footer-content">
            <p>Rua Epaminondas Nogueira 1425 - Centro - Valen√ßa do Piau√≠</p>
            <p>CNPJ: 06.095.146/0001-44 - e-mail: seme.valenca@yahoo.com.br</p>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <td>
                    <div class="header-space">&nbsp;</div>
                </td>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>
                    <div class="content-wrapper" style="padding: 0 1cm;">
                        
                        <div class="doc-title">
                            {{ doc.tipo_documento|upper }} N¬∫ {{ doc.numero_documento }}
                        </div>

                        <div class="block destinatario">
                            <strong>A Sua Senhoria o(a) Senhor(a)</strong>
                            <div class="nome">{{ doc.destinatario_nome|upper }}</div>
                            {% if doc.destinatario_cargo %}
                                <div>{{ doc.destinatario_cargo }}</div>
                            {% endif %}
                        </div>

                        <div class="block assunto">
                            ASSUNTO: {{ doc.assunto }}
                        </div>

                        <div class="block">
                            <div class="paragraph">
                                {{ doc.vocativo if doc.vocativo else 'Prezado(a) Senhor(a),' }}
                            </div>
                            <div class="paragraph">
                                {{ doc.corpo_texto }}
                            </div>
                        </div>

                        <div class="fecho">
                            <p>{{ doc.fecho if doc.fecho else 'Atenciosamente,' }}</p>
                            {{ doc.local_emissao }}, {{ data_extenso }}.
                        </div>

                        <div class="signature">
                            <div class="signature-line"></div>
                            <div class="signature-name">{{ doc.responsavel_assinatura|upper }}</div>
                            <div class="signature-role">Respons√°vel T√©cnico / PNAE</div>
                        </div>

                    </div>
                    </td>
            </tr>
        </tbody>

        <tfoot>
            <tr>
                <td>
                    <div class="footer-space">&nbsp;</div>
                </td>
            </tr>
        </tfoot>
    </table>

</body>
</html>